<div class="edit-user-container">
    <div class="header">
        <h1>{{ isNewUser ? 'Create New User' : 'Edit User' }}</h1>
    </div>

    <div *ngIf="loading" class="loading">
        Loading...
    </div>

    <div *ngIf="error" class="error-message">
        {{ error }}
    </div>

    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" *ngIf="!loading" class="user-form">
        <div class="form-group">
            <label for="username">Username*</label>
            <input type="text" id="username" formControlName="username" class="form-control" [ngClass]="{ 'invalid': isFieldInvalid('username') }">
            <div *ngIf="isFieldInvalid('username')" class="error-hint">
                Username is required (max 100 characters)
            </div>
        </div>

        <div class="form-group">
            <label for="email">Email*</label>
            <input type="email" id="email" formControlName="email" class="form-control" [ngClass]="{ 'invalid': isFieldInvalid('email') }">
            <div *ngIf="isFieldInvalid('email')" class="error-hint">
                Valid email is required
            </div>
        </div>

        <div class="form-group">
            <label for="firstName">First Name*</label>
            <input type="text" id="firstName" formControlName="firstName" class="form-control" [ngClass]="{ 'invalid': isFieldInvalid('firstName') }">
            <div *ngIf="isFieldInvalid('firstName')" class="error-hint">
                First name is required (max 100 characters)
            </div>
        </div>

        <div class="form-group">
            <label for="lastName">Last Name*</label>
            <input type="text" id="lastName" formControlName="lastName" class="form-control" [ngClass]="{ 'invalid': isFieldInvalid('lastName') }">
            <div *ngIf="isFieldInvalid('lastName')" class="error-hint">
                Last name is required (max 100 characters)
            </div>
        </div>

        <div class="form-group">
            <label for="address">Address</label>
            <input type="text" id="address" formControlName="address" class="form-control" [ngClass]="{ 'invalid': isFieldInvalid('address') }">
            <div *ngIf="isFieldInvalid('address')" class="error-hint">
                Address is required
            </div>
        </div>

        <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="text" id="phone" formControlName="phone" class="form-control">
        </div>

        <div class="form-group" *ngIf="isNewUser">
            <label for="password">Password (Leave empty for default password)</label>
            <input type="password" id="password" formControlName="password" class="form-control">
            <div class="hint">
                If left empty, a default password "changeme" will be set
            </div>
        </div>

        <div class="form-group">
            <label for="role">Role*</label>
            <select id="role" formControlName="role" class="form-control" [ngClass]="{ 'invalid': isFieldInvalid('role') }">
                <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
            </select>
            <div *ngIf="isFieldInvalid('role')" class="error-hint">
                Role is required
            </div>
        </div>

        <div class="form-actions">
            <button type="button" class="cancel-btn" (click)="cancel()">Cancel</button>
            <button type="submit" class="save-btn" [disabled]="loading">
                {{ isNewUser ? 'Create User' : 'Save Changes' }}
            </button>
        </div>
    </form>
</div>
